# Старые файлы - Архив

Эта папка содержит старые файлы, которые были заменены новой архитектурой проекта.

## Перемещенные файлы:

### 1. `config.py`
**Старая конфигурация** - заменена на `src/config/settings.py`
- Содержал все переменные окружения и настройки
- Функции транслитерации и определения языка
- Перенесены в новую структуру конфигурации

### 2. `reply_handler.py`
**Обработчик ответов на сообщения** - функциональность перенесена в сервисы
- Обработка выбора букетов через reply
- Извлечение названий букетов из подписей
- Валидация выбора товаров
- Заменен на `services/command_service.py` и `services/catalog_service.py`

### 3. `json_processor.py`
**Обработчик JSON ответов от AI** - функциональность перенесена в `services/ai_service.py`
- Парсинг ответов от Gemini AI
- Исправление некорректного JSON через AI
- Извлечение команд и текста
- Интегрирован в `AIService.parse_ai_response()`

### 4. `chat_history_processor.py`
**Обработчик истории чатов** - функциональность перенесена в сервисы
- Получение истории диалогов
- Форматирование сообщений для HTML
- Обработка многоязычных сообщений
- Заменен на `services/message_service.py` и `services/session_service.py`

### 5. `chat_translation_manager.py`
**Менеджер переводов чатов** - функциональность перенесена в `services/ai_service.py`
- Перевод сообщений между языками
- Сохранение переводов в базу данных
- Обработка многоязычных диалогов
- Интегрирован в `AIService.translate_text()` и связанные методы

### 6. `catalog_reader.py`
**Чтение каталога товаров** - заменен на `services/catalog_service.py`
- Получение товаров из WhatsApp Business API
- Валидация товаров
- Форматирование каталога для AI
- Заменен на `CatalogService`

### 7. `catalog_sender.py`
**Отправка каталога через WhatsApp** - функциональность перенесена в `services/catalog_service.py`
- Отправка товаров с изображениями
- Обработка подписей к изображениям
- Сохранение message_id для reply
- Интегрирован в `CatalogService.send_catalog()`

### 8. `template_utils.py`
**Утилиты для HTML шаблонов** - не используется в новой архитектуре
- Форматирование сообщений в HTML
- Рендеринг шаблонов
- Обработка ошибок
- Заменен на прямую работу с FastAPI и Jinja2

### 9. `debug_interface.py`
**Отладочный веб-интерфейс** - не используется в продакшене
- Сбор логов для отладки
- Веб-интерфейс для просмотра логов
- Ограниченное использование только в разработке

## Примечания:

- Все файлы сохранены для обратной совместимости
- Новая архитектура использует сервисный подход с четким разделением ответственности
- Основная логика перенесена в соответствующие сервисы в папке `services/`
- Конфигурация вынесена в отдельную папку `config/`
- Модели данных вынесены в папку `models/`
- Репозитории для работы с БД вынесены в папку `repositories/`

## Дата архивирования:
Файлы перемещены в архив при рефакторинге архитектуры проекта. 